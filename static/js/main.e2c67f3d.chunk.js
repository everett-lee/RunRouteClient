(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{186:function(e,t,n){e.exports=n(332)},332:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(33),l=n.n(o),u=n(26),c=n(348),i=n(343),s=n(349),d=n(341),m=n(344),p=Object(a.createContext)(),v=function(e){var t=e.routeCoords,n=Object(a.useContext)(p),o=Object(a.useState)(13),l=Object(u.a)(o,2),c=l[0],v=l[1],f=function(e){var t=e.latlng.lat,a=e.latlng.lng;n.setCoords({lat:t,lon:a})},g=function(e){v(e.target._zoom)},E=[n.coords.lat,n.coords.lon],h=r.a.createElement(i.a,{center:E,onmouseDown:function(e){return f(e)},onZoomend:function(e){return g(e)},zoom:c},r.a.createElement(s.a,{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),r.a.createElement(d.a,{position:E})),b=r.a.createElement(i.a,{center:E,onClick:function(e){return f(e)},onZoomend:function(e){return g(e)},zoom:c},r.a.createElement(s.a,{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),r.a.createElement(m.a,{color:"blue",positions:function(){var e=t?t.length:0,n=e>0?Math.floor(e/2):0;if(t)return t.slice(0,n)}()}),r.a.createElement(m.a,{color:"red",opacity:.7,positions:function(){var e=t?t.length:0,n=e>0?Math.floor(e/2):0;if(t)return t.slice(n-1,e)}()}));return t?b:h},f=n(76),g=n(77),E=n(82),h=n(78),b=n(83),C=function(e){var t=e.onSliderInputChange;return r.a.createElement("div",{className:"slidecontainer"},r.a.createElement("input",{type:"range",onChange:function(e){return t(e)},min:0,max:30,defaultValue:15,className:"slider",id:"myRange"}))},O=n(342),j=function(e){var t=e.onDistanceInput,n=e.onSliderInputChange,a=e.maxGradient;return r.a.createElement(O.a,null,r.a.createElement(O.a.Group,{widths:"equal"},r.a.createElement(O.a.Field,null,r.a.createElement("label",null,"Target distance (KM)"),r.a.createElement("input",{type:"text",onChange:function(e){return t(e)},placeholder:"Distance (KM)"})),r.a.createElement(O.a.Field,null,r.a.createElement("label",null,"Maximum gradient"),r.a.createElement(C,{onSliderInputChange:n})),r.a.createElement("div",{className:"maxGradientVal",style:{marginTop:"20px"}},a,"%")))},x=function(e){var t=e.arg,n=e.label,a=e.onInputChange;return r.a.createElement("div",{className:"ui checkbox"},r.a.createElement("input",{type:"checkbox",onClick:function(){return a(t)}}),r.a.createElement("label",null,n))},F=function(e){var t=e.onAvoidedFeaturesButtonInputChange,n=e.onPreferredFeaturesButtonInputChange;return r.a.createElement(O.a,null,r.a.createElement(O.a.Group,{widths:"equal"},r.a.createElement(O.a.Field,null,r.a.createElement("label",null,"Features to avoid"),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:t,arg:"majorRoads",label:"Major roads"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:t,arg:"steps",label:"Steps"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:t,arg:"concrete",label:"Concrete"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:t,arg:"unlit",label:"Unlit streets"}))),r.a.createElement(O.a.Field,null,r.a.createElement("label",null,"Preferred features"),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:n,arg:"uphill",label:"Prefer uphill"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:n,arg:"residential",label:"Residential streets"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:n,arg:"grassOrDirt",label:"Unpaved sufaces"})),r.a.createElement("div",null,r.a.createElement(x,{onInputChange:n,arg:"backroads",label:"Backroads and pathways"})))))},I=n(346),k=function(e){function t(e){var n;Object(f.a)(this,t),(n=Object(E.a)(this,Object(h.a)(t).call(this,e))).onDistanceInput=function(e){n.setState({distance:e.target.value})},n.onSliderInputChange=function(e){n.setState({maxGradient:e.target.value})},n.onAvoidedFeaturesButtonInputChange=function(e){var t=n.state.avoidedFeatures[e],a=n.state.avoidedFeatures;a[e]=!t,n.setState({avoidedFeatures:a})},n.onPreferredFeaturesButtonInputChange=function(e){var t=n.state.preferredFeatures[e],a=n.state.preferredFeatures;a[e]=!t,n.setState({preferredFeatures:a})};return n.state={distance:null,maxGradient:15,avoidedFeatures:{majorRoads:!1,steps:!1,concrete:!1,unlit:!1},preferredFeatures:{uphill:!1,residential:!1,backroads:!1,grassOrDirt:!1}},n}return Object(b.a)(t,e),Object(g.a)(t,[{key:"render",value:function(e){var t=this;return r.a.createElement(I.a,null,r.a.createElement(j,{onSliderInputChange:this.onSliderInputChange,onDistanceInput:this.onDistanceInput,maxGradient:this.state.maxGradient}),r.a.createElement(F,{onAvoidedFeaturesButtonInputChange:this.onAvoidedFeaturesButtonInputChange,onPreferredFeaturesButtonInputChange:this.onPreferredFeaturesButtonInputChange}),r.a.createElement("button",{onClick:function(){return t.props.makeRequest(t.state)},className:"ui button"},"Find route"),r.a.createElement("button",{onClick:function(){return t.props.resetMap()},className:"ui button"},"Save route"))}}]),t}(r.a.Component),y=n(347),N=function(e){var t=e.coords,n=e.routeName,a=e.routeDistance,o=e.routeGradient,l=t.lat.toFixed(2),u=t.lon.toFixed(2),c=a?(a/1e3).toFixed(1)+"KM":"",i=o?(100*o).toFixed(1)+"%":"";return r.a.createElement(I.a,null,r.a.createElement(y.a,{columns:3,textAlign:"center"},r.a.createElement(y.a.Column,null,"Route start: ".concat(n||" ")," (",l,", ",u,")"),r.a.createElement(y.a.Column,null,"Distance: ".concat(c)),r.a.createElement(y.a.Column,null,"Average gradient: ".concat(i))))},G=n(107),S=n.n(G),D=n(175),w=document.getElementById("modal-root"),P=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(E.a)(this,Object(h.a)(t).call(this,e))).el=document.createElement("div"),n}return Object(b.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){w.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){w.removeChild(this.el)}},{key:"render",value:function(){return l.a.createPortal(r.a.createElement("div",{className:"ui dimmer modals visibile ".concat(!0===this.props.active?"active":"")},r.a.createElement("div",{className:"ui standard modal visible ".concat(!0===this.props.active?"active":"")},r.a.createElement("div",{className:"ui inverted dimmer ".concat(!0===this.props.active?"active":"")},r.a.createElement("div",{className:"ui big text loader"},this.props.text)))),this.el)}}]),t}(r.a.Component),R=n(108),B=n.n(R),M=Object(a.createContext)(),q=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(M);return Object(a.useEffect)(function(){window.navigator.geolocation.getCurrentPosition(function(n){var a=n.coords.latitude,r=n.coords.longitude;e.setCoords({lat:a,lon:r}),t.sendCoords(a,r)},function(e){return console.log(e)})},[]),null},A=function(e){var t=e.name,n=e.routeCoords,a=e.distance,o=e.gradient,l=e.reloadOldRoute;return r.a.createElement(I.a,{content:t,id:"sidebarSegment",textAlign:"center",onClick:function(){return l(n,t,a,o)}})},z=function(){var e=Object(a.useContext)(M),t=Object(a.useContext)(p),n={routeCoords:null,routeName:null,routeDistance:null,routeGradient:null},o=Object(a.useState)(n),l=Object(u.a)(o,2),i=l[0],s=l[1],d=Object(a.useState)([]),m=Object(u.a)(d,2),f=m[0],g=m[1],E=function(e,t,n,a){s({routeCoords:e,routeName:t,routeDistance:n,routeGradient:a})};return r.a.createElement("div",null,r.a.createElement(c.a,{visible:!0},f.map(function(e){return r.a.createElement(A,{routeCoords:e.routeCoords,name:e.name,distance:e.distance,gradient:e.gradient,key:e.key,reloadOldRoute:E})})),r.a.createElement("div",{className:"ui container"},r.a.createElement(k,{makeRequest:function(a){var r=t.coords;e.sendRequest(a,r.lat,r.lon).then(function(e){s(e||n)})},resetMap:function(){if(i.routeName){var e=f.length,t={name:i.routeName,distance:i.routeDistance,routeCoords:i.routeCoords,gradient:i.routeGradient,key:e};g(f.concat([t]))}s(n)}}),r.a.createElement(N,{coords:t.coords,routeName:i.routeName,routeDistance:i.routeDistance,routeGradient:i.routeGradient}),r.a.createElement("div",{className:"map-display-div"},r.a.createElement(v,{routeCoords:i.routeCoords})),r.a.createElement(q,null)))},U=(n(331),Object(a.createContext)());l.a.render(r.a.createElement(function(e){var t=e.children,n="http://localhost:8080",o=Object(a.useState)("Generating route"),l=Object(u.a)(o,2),c=l[0],i=l[1],s=Object(a.useState)(!1),d=Object(u.a)(s,2),m=d[0],p=d[1],v=function(){var e=Object(D.a)(S.a.mark(function e(t,n,a){var r,o;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i("Generating route"),r=E(t,n,a),p(!0),e.next=5,B.a.get(r).catch(function(e){return g(e)});case 5:if(o=e.sent,p(!1),!o){e.next=9;break}return e.abrupt("return",{routeCoords:f(o.data.pathNodes),routeName:o.data.startingWay,routeDistance:o.data.distance,routeGradient:o.data.averageGradient});case 9:case 10:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),f=function(e){return e.map(function(e){return Object.keys(e).filter(function(e){return"id"!==e}).map(function(t){return e[t]})})},g=function(e){var t;return t=e.response?e.response.data.message:"Unable to reach the server",i("Error: ".concat(t)),new Promise(function(e){return setTimeout(e,2e3)})},E=function(e,t,a){var r=Object.values(e.avoidedFeatures),o=Object.values(e.preferredFeatures),l=0===r.length?"":",",u=1e3*e.distance,c=e.maxGradient/100;return n+"/route/args?"+"lat=".concat(t.toFixed(6),"&lon=").concat(a.toFixed(6),"&")+"distance=".concat(u,"&maxGradient=").concat(c,"&")+"options=".concat(r+l+o)};return r.a.createElement("div",null,r.a.createElement(P,{active:m,text:c}),r.a.createElement(M.Provider,{value:{sendCoords:function(e,t){var a="lat=".concat(e,"&lon=").concat(t);B.a.get(n+"/start/args?"+a).catch(function(e){return console.log(e)})},sendRequest:v}},t))},null,r.a.createElement(function(e){var t=e.children,n=Object(a.useState)({lat:51.505,lon:-.09}),o=Object(u.a)(n,2),l=o[0],c=o[1];return r.a.createElement(p.Provider,{value:{coords:l,setCoords:c}},t)},null,r.a.createElement(function(e){var t=e.children,n=Object(a.useState)({routeCoords:null,routeName:null,routeDistance:null,routeGradient:null}),o=Object(u.a)(n,2),l=o[0],c=o[1];return r.a.createElement(U.Provider,{value:{routeObject:l,setRouteObject:c}},t)},null,r.a.createElement(z,null)))),document.querySelector("#app-root"))}},[[186,1,2]]]);
//# sourceMappingURL=main.e2c67f3d.chunk.js.map